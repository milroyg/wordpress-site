import{EacSwiper,setGridItemsGlobalLink}from"../modules/eac-modules.js";class widgetRelationshipACF extends elementorModules.frontend.handlers.Base{getDefaultSettings(){return{selectors:{targetInstance:".eac-acf-relationship",targetArticles:"article",targetCards:".acf-relation_inner-wrapper",targetSkipGrid:".eac-skip-grid",target:".acf-relation_container"}}}getDefaultElements(){const e=this.getSettings("selectors");let t={$targetInstance:this.$element.find(e.targetInstance),$targetArticles:this.$element.find(e.targetArticles),$targetCards:this.$element.find(e.targetCards),$targetSkipGrid:this.$element.find(e.targetSkipGrid),$target:this.$element.find(e.target),settings:this.$element.find(e.target).data("settings")||{},has_swiper:!1};return t.has_swiper=t.settings.data_sw_swiper,t}onInit(){super.onInit(),this.elements.has_swiper&&new EacSwiper(this.elements.settings,this.elements.$targetInstance),elementorFrontend.isEditMode()||setGridItemsGlobalLink(this.elements.$targetCards)}bindEvents(){this.elements.$targetArticles.length>0&&(this.elements.$targetInstance.on("keydown",(e=>{this.setKeyboardEvents(e)})),jQuery.each(this.elements.$targetArticles,((e,t)=>{new IntersectionObserver(this.observeGridInViewport.bind(this),{threshold:.5}).observe(t)})))}observeGridInViewport(e,t){if(e[0].isIntersecting){const s=e[0].target;this.elements.settings.data_animate&&jQuery(s).addClass("animate-first-load"),t.unobserve(s),window.setTimeout((()=>{jQuery(s).removeClass("animate-first-load")}),1e3)}}setKeyboardEvents(e){const t=e.code||e.key||0,s='button, a, [tabindex]:not([tabindex="-1"])';if("Tab"===t&&!e.shiftKey||"Tab"===t&&e.shiftKey)return!0;if("Home"===t){e.preventDefault();this.elements.$targetArticles.first().find(s).first().trigger("focus")}else if("End"===t){e.preventDefault();this.elements.$targetArticles.last().find(s).last().trigger("focus")}else"Escape"===t&&this.elements.$targetSkipGrid.trigger("focus")}}jQuery(window).on("elementor/frontend/init",(()=>{elementorFrontend.elementsHandler.attachHandler("eac-addon-acf-relationship",widgetRelationshipACF)}));