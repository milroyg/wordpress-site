class widgetTableOfContent extends elementorModules.frontend.handlers.Base{getDefaultSettings(){return{selectors:{targetInstance:".eac-table-of-content",toc:"#toctoc",tocHead:"#toctoc-head",tocHeadToggler:"#toctoc-head__toggler",tocHeadTogglerSvg:"#toctoc-head__toggler svg",tocHeadTogglerAwe:"#toctoc-head__toggler i",tocBody:"#toctoc-body",tocBodyList:"#toctoc-body__list"}}}getDefaultElements(){const e=this.getSettings("selectors");return{$targetInstance:this.$element.find(e.targetInstance),$toc:this.$element.find(e.toc),$tocHead:this.$element.find(e.tocHead),$tocBody:this.$element.find(e.tocBody),$tocBodyList:this.$element.find(e.tocBodyList),$tocHeadToggler:this.$element.find(e.tocHeadToggler),$tocHeadTogglerIcon:this.$element.find(e.tocHeadTogglerSvg),settings:{listType:this.$element.find(e.targetInstance).data("settings").data_type,target:this.$element.find(e.targetInstance).data("settings").data_target,opened:this.$element.find(e.targetInstance).data("settings").data_opened,headPicto:["▼","▲"],headings:this.$element.find(e.targetInstance).data("settings").data_headings,trailer:this.$element.find(e.targetInstance).data("settings").data_trailer,ariaLabel:this.$element.find(e.targetInstance).data("settings").data_label,exclude:this.$element.find(e.targetInstance).data("settings").data_exclude,windowWith:window.innerWidth,$linksList:[]}}}onInit(){super.onInit(),window.location.hash&&setTimeout((()=>{let e=window.location.hash;window.location.hash="",window.location.hash=e}),500),this.elements.settings.opened&&this.elements.$tocHeadTogglerIcon.css("transform","rotate(180deg)"),"numbered"===this.elements.settings.listType?this.elements.$tocBodyList.css("list-style","none"):"picto"===this.elements.settings.listType?(this.elements.$tocBodyList.css("list-style","none"),this.elements.$tocBodyList.addClass("not-numbered")):(this.elements.$tocBodyList.addClass("not-numbered"),this.elements.$tocBodyList.css({"list-style":this.elements.settings.listType,"list-style-position":"inside"})),this.buildAnchorLinks()}bindEvents(){this.elements.$tocHead.on("click",this.onHeadClickKeyboardEvent.bind(this)),elementorFrontend.isEditMode()||(this.elements.$tocHead.on("keydown",this.onHeadClickKeyboardEvent.bind(this)),this.elements.$tocBody.on("keydown",this.onBodyListKeyboardEvent.bind(this)))}buildAnchorLinks(){const e=this.elements.settings.target+" ",t=(e+this.elements.settings.headings.split(",").join(","+e)).split(",").join(","),s=this.getElementSettings("toc_content_picto");let n;if(s)if(elementorFrontend.config.experimentalFeatures.e_font_icon_svg&&!elementorFrontend.isEditMode()){const e=void 0!==s.rendered_tag?s.rendered_tag:"";e&&(n=e.replace("<svg",'<svg aria-hidden="true"'))}else n=s.value?`<i class="${s.value}" aria-hidden='true'></i>`:"";if(this.elements.settings.exclude.push("eac-breadcrumbs-item"),"numbered"!==this.elements.settings.listType){let e="",s=1;jQuery(t).each(((t,i)=>{const o=jQuery(i),l=o.closest(".elementor-widget");let a=!1;if(o.attr("class")&&this.elements.settings.exclude.length>0&&jQuery(o.attr("class").split(" ")).each(((e,t)=>{jQuery.inArray(t,this.elements.settings.exclude)>=0&&(a=!0)})),a)return!0;if(!l.is(":hidden")&&o.text().length>0){const t=o.text().replace(/\s+/g," "),i=this.elements.settings.trailer?"-"+s:"",l=o.prop("tagName").toLowerCase(),a=t.toSlug(),d=o.is("[id]")?o.attr("id"):a+i,r=this.elements.settings.ariaLabel+t;let c="";o.attr("id",d).addClass("toctoc-jump-link"),c="picto"===this.elements.settings.listType?'<span class="link eac-icon-svg link-'+l+'">'+n+'</span><a href="#'+d+'" aria-label="'+r+'"><span>'+t+"</span></a>":'<a href="#'+d+'" aria-label="'+r+'"><span class="link link-'+l+'">'+t+"</span></a>",e+="<li>"+c+"</li>",s++}})),this.elements.$tocBodyList.append(e)}else this.elements.$tocBodyList.toc({content:e,headings:this.elements.settings.headings,suffixe:this.elements.settings.trailer,exclude:this.elements.settings.exclude});this.elements.settings.opened&&this.elements.$tocBody.css("display","block"),this.elements.$linksList=this.elements.$tocBodyList.find("a")}onHeadClickKeyboardEvent(e){if("keydown"===e.type){const t=e.code||e.key||0;if("Enter"!==t&&"Space"!==t)return}e.preventDefault(),this.elements.settings.opened?this.elements.settings.opened=!1:this.elements.settings.opened=!0,this.elements.settings.opened?(this.elements.$tocHeadTogglerIcon.css("transform","rotate(180deg)"),this.elements.$tocHead.attr("aria-expanded","true")):(this.elements.$tocHeadTogglerIcon.css("transform","rotate(0deg)"),this.elements.$tocHead.attr("aria-expanded","false")),this.elements.$tocBody.slideToggle(300)}onBodyListKeyboardEvent(e){const t=document.activeElement,s=e.code||e.key||0;if("Escape"===s)this.elements.$tocHeadTogglerIcon.css("transform","rotate(0deg)"),this.elements.$tocHead.attr("aria-expanded","false"),this.elements.$tocBody.slideToggle(300),this.elements.$tocHead.trigger("focus");else if("ArrowDown"===s){let s=t;if(e.preventDefault(),jQuery(s).hasClass("toctoc-head"))s=this.elements.$linksList.get(0);else if(jQuery(s).attr("href")){const e=this.elements.$linksList.index(jQuery(s));s=e===this.elements.$linksList.length-1?this.elements.$linksList.get(0):e+1<this.elements.$linksList.length?this.elements.$linksList.get(e+1):this.elements.$linksList.get(e)}jQuery(s).trigger("focus")}else if("ArrowUp"===s){let s=t;if(e.preventDefault(),jQuery(s).attr("href")){const e=this.elements.$linksList.index(jQuery(s));s=e-1>0?this.elements.$linksList.get(e-1):this.elements.$linksList.get(0)}jQuery(s).trigger("focus")}}onResizeWindow(){this.elements.settings.windowWith!==window.innerWidth&&(this.elements.settings.windowWith=window.innerWidth,this.elements.settings.opened=!1,this.elements.$tocHeadTogglerIcon.css("transform","rotate(0deg)"),this.elements.$tocBodyList.slideUp(300))}onOrientationChangeWindow(){window.dispatchEvent(new Event("resize"))}}jQuery(window).on("elementor/frontend/init",(()=>{elementorFrontend.elementsHandler.attachHandler("eac-addon-toc",widgetTableOfContent)}));